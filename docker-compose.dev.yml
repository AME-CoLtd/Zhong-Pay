version: '3.8'
# 开发环境覆盖配置
# 使用: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

services:
  mysql:
    ports:
      - "3306:3306"   # 开发时暴露端口方便调试

  server:
    build:
      target: builder
    command: npm run dev
    volumes:
      - ./packages/server/src:/app/src
      - ./packages/server/prisma:/app/prisma
    environment:
      NODE_ENV: development
    ports:
      - "3000:3000"

  nginx:
    ports:
      - "80:80"
    volumes:
      - ./docker/nginx/conf.d/dev.conf:/etc/nginx/conf.d/default.conf:ro
